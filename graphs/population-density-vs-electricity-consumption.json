{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 600,
  "height": 400,
  "title": "Population Density vs Total Population by SA2 Region",
  "data": {
    "url": "../data/population-sa2s.csv"
  },
  "transform": [
    {"calculate": "datum.sa2_name || datum.SA2_NAME || 'Unnamed'", "as": "region_name"}
  ],
  "mark": {
    "type": "point",
    "filled": true,
    "opacity": 0.7
  },
  "encoding": {
    "x": {
      "field": "persons/km2",
      "type": "quantitative",
      "scale": {"type": "linear"},
      "axis": {"title": "Population Density (persons/km²)"}
    },
    "y": {
      "field": "pop_2022",
      "type": "quantitative",
      "axis": {"title": "Total Population (2022)"}
    },
    "size": {
      "field": "km2",
      "type": "quantitative",
      "scale": {"range": [10, 500]},
      "legend": {"title": "Area (km²)"}
    },
    "color": {
      "field": "pop_2023",
      "type": "quantitative",
      "scale": {"scheme": "viridis"},
      "legend": {"title": "Population in 2023"}
    },
    "tooltip": [
      {"field": "region_name", "type": "nominal", "title": "SA2 Region"},
      {"field": "persons/km2", "type": "quantitative", "title": "Population Density", "format": ".2f"},
      {"field": "pop_2023", "type": "quantitative", "title": "Population (2023)"},
      {"field": "km2", "type": "quantitative", "title": "Area (km²)", "format": ".1f"}
    ]
  }
}